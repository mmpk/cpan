montageDefine("7864825","vendor/requirejs/tests/doh/runner",{dependencies:[],factory:function(require,exports,module){this.doh||(doh={}),doh.selfTest=!1,doh.global=this,doh.hitch=function(e,i){for(var t=[],a=2;arguments.length>a;a++)t.push(arguments[a]);var s=("string"==typeof i?e[i]:i)||function(){};return function(){for(var i=t.concat([]),a=0;arguments.length>a;a++)i.push(arguments[a]);return s.apply(e,i)}},doh._mixin=function(e,i){var t={};for(var a in i)(void 0===t[a]||t[a]!=i[a])&&(e[a]=i[a]);return this.document&&document.all&&"function"==typeof i.toString&&i.toString!=e.toString&&i.toString!=t.toString&&(e.toString=i.toString),e},doh.mixin=function(e){for(var i=1,t=arguments.length;t>i;i++)doh._mixin(e,arguments[i]);return e},doh.extend=function(e){for(var i=1,t=arguments.length;t>i;i++)doh._mixin(e.prototype,arguments[i]);return e},doh._line="------------------------------------------------------------",doh.debug=function(){},doh._AssertFailure=function(e,i){return this instanceof doh._AssertFailure?(i&&(e=new String(e||"")+" with hint: \n		"+(new String(i)+"\n")),this.message=new String(e||""),this):new doh._AssertFailure(e,i)},doh._AssertFailure.prototype=Error(),doh._AssertFailure.prototype.constructor=doh._AssertFailure,doh._AssertFailure.prototype.name="doh._AssertFailure",doh.Deferred=function(e){this.chain=[],this.id=this._nextId(),this.fired=-1,this.paused=0,this.results=[null,null],this.canceller=e,this.silentlyCancelled=!1},doh.extend(doh.Deferred,{getTestErrback:function(e,i){var t=this;return function(){try{e.apply(i||doh.global||t,arguments)}catch(a){t.errback(a)}}},getTestCallback:function(e,i){var t=this;return function(){try{e.apply(i||doh.global||t,arguments)}catch(a){return t.errback(a),void 0}t.callback(!0)}},getFunctionFromArgs:function(){var e=arguments;if(e[0]&&!e[1]){if("function"==typeof e[0])return e[0];if("string"==typeof e[0])return doh.global[e[0]]}else if(e[0]&&e[1])return doh.hitch(e[0],e[1]);return null},makeCalled:function(){var e=new doh.Deferred;return e.callback(),e},_nextId:function(){var e=1;return function(){return e++}}(),cancel:function(){-1==this.fired?(this.canceller?this.canceller(this):this.silentlyCancelled=!0,-1==this.fired&&this.errback(Error("Deferred(unfired)"))):0==this.fired&&this.results[0]instanceof doh.Deferred&&this.results[0].cancel()},_pause:function(){this.paused++},_unpause:function(){this.paused--,0==this.paused&&this.fired>=0&&this._fire()},_continue:function(e){this._resback(e),this._unpause()},_resback:function(e){this.fired=e instanceof Error?1:0,this.results[this.fired]=e,this._fire()},_check:function(){if(-1!=this.fired){if(!this.silentlyCancelled)throw Error("already called!");return this.silentlyCancelled=!1,void 0}},callback:function(e){this._check(),this._resback(e)},errback:function(e){this._check(),e instanceof Error||(e=Error(e)),this._resback(e)},addBoth:function(e,i){var t=this.getFunctionFromArgs(e,i);return arguments.length>2&&(t=doh.hitch(null,t,arguments,2)),this.addCallbacks(t,t)},addCallback:function(e,i){var t=this.getFunctionFromArgs(e,i);return arguments.length>2&&(t=doh.hitch(null,t,arguments,2)),this.addCallbacks(t,null)},addErrback:function(e,i){var t=this.getFunctionFromArgs(e,i);return arguments.length>2&&(t=doh.hitch(null,t,arguments,2)),this.addCallbacks(null,t)},addCallbacks:function(e,i){return this.chain.push([e,i]),this.fired>=0&&this._fire(),this},_fire:function(){for(var e=this.chain,i=this.fired,t=this.results[i],a=this,s=null;e.length>0&&0==this.paused;){var u=e.shift(),n=u[i];if(null!=n)try{t=n(t),i=t instanceof Error?1:0,t instanceof doh.Deferred&&(s=function(e){a._continue(e)},this._pause())}catch(l){i=1,t=l}}this.fired=i,this.results[i]=t,s&&this.paused&&t.addBoth(s)}}),doh._testCount=0,doh._groupCount=0,doh._errorCount=0,doh._failureCount=0,doh._currentGroup=null,doh._currentTest=null,doh._paused=!0,doh._init=function(){this._currentGroup=null,this._currentTest=null,this._errorCount=0,this._failureCount=0,this.debug(this._testCount,"tests to run in",this._groupCount,"groups")},doh._groups={},doh.registerTestNs=function(e,i){for(var t in i)"_"!=t.charAt(0)&&"function"==typeof i[t]&&this.registerTest(e,i[t])},doh._testRegistered=function(){},doh._groupStarted=function(){},doh._groupFinished=function(){},doh._testStarted=function(){},doh._testFinished=function(){},doh.registerGroup=function(e,i,t,a,s){i&&this.register(e,i,s),t&&(this._groups[e].setUp=t),a&&(this._groups[e].tearDown=a)},doh._getTestObj=function(e,i,t){var a=i;if("string"==typeof i){if("url:"==i.substr(0,4))return this.registerUrl(e,i);a={name:i.replace("/s/g","_")},a.runTest=Function("t",i)}else if("function"==typeof i)if(a={runTest:i},i.name)a.name=i.name;else try{var s="function ",u=a.runTest+"";u.indexOf(s)>=0&&(a.name=u.split(s)[1].split("(",1)[0])}catch(n){}return("perf"===t||"perf"===a.testType)&&(a.testType="perf",doh.perfTestResults||(doh.perfTestResults={},doh.perfTestResults[e]={}),doh.perfTestResults[e]||(doh.perfTestResults[e]={}),doh.perfTestResults[e][a.name]||(doh.perfTestResults[e][a.name]={}),a.results=doh.perfTestResults[e][a.name],"trialDuration"in a||(a.trialDuration=100),"trialDelay"in a||(a.trialDelay=100),"trialIterations"in a||(a.trialIterations=10)),a},doh.registerTest=function(e,i,t){this._groups[e]||(this._groupCount++,this._groups[e]=[],this._groups[e].inFlight=0);var a=this._getTestObj(e,i,t);return a?(this._groups[e].push(a),this._testCount++,this._testRegistered(e,a),a):null},doh.registerTests=function(e,i,t){for(var a=0;i.length>a;a++)this.registerTest(e,i[a],t)},doh.registerUrl=function(){this.debug("ERROR:"),this.debug("	NO registerUrl() METHOD AVAILABLE.")},doh.registerString=function(){},doh.register=doh.add=function(e,i,t){return 1==arguments.length&&"string"==typeof e&&("url:"==e.substr(0,4)?this.registerUrl(e,null,null,t):this.registerTest("ungrouped",e,t)),1==arguments.length?(this.debug("invalid args passed to doh.register():",e,",",i),void 0):"string"==typeof i?("url:"==i.substr(0,4)?this.registerUrl(i,null,null,t):this.registerTest(e,i,t),void 0):doh._isArray(i)?(this.registerTests(e,i,t),void 0):(this.registerTest(e,i,t),void 0)},doh.registerDocTests=function(e){this.debug("registerDocTests() requires dojo to be loaded into the environment. Skipping doctest set for module:",e)},function(){if("undefined"!=typeof dojo){try{dojo.require("dojox.testing.DocTest")}catch(e){return console.debug(e),doh.registerDocTests=function(){},void 0}doh.registerDocTests=function(e){for(var i=new dojox.testing.DocTest,t=i.getTests(e),a=t.length,s=[],u=0;a>u;u++){var n=t[u],l="";if(n.commands.length&&-1!=n.commands[0].indexOf("//")){var r=n.commands[0].split("//");l=", "+r[r.length-1]}s.push({runTest:function(e){return function(t){var a=i.runTest(e.commands,e.expectedResult);t.assertTrue(a.success)}}(n),name:"Line "+n.line+l})}this.register("DocTests: "+e,s)}}}(),doh.t=doh.assertTrue=function(condition,hint){if(1>arguments.length)throw new doh._AssertFailure("assertTrue failed because it was not passed at least 1 argument");if(!eval(condition))throw new doh._AssertFailure("assertTrue('"+condition+"') failed",hint)},doh.f=doh.assertFalse=function(condition,hint){if(1>arguments.length)throw new doh._AssertFailure("assertFalse failed because it was not passed at least 1 argument");if(eval(condition))throw new doh._AssertFailure("assertFalse('"+condition+"') failed",hint)},doh.e=doh.assertError=function(e,i,t,a,s){try{i[t].apply(i,a)}catch(u){if(u instanceof e)return!0;throw new doh._AssertFailure("assertError() failed:\n	expected error\n		"+e+"\n	but got\n		"+u+"\n\n",s)}throw new doh._AssertFailure("assertError() failed:\n	expected error\n		"+e+"\n	but no error caught\n\n",s)},doh.is=doh.assertEqual=function(e,i,t){if(void 0===e&&void 0===i)return!0;if(2>arguments.length)throw doh._AssertFailure("assertEqual failed because it was not passed 2 arguments");if(e===i||e==i||"number"==typeof e&&"number"==typeof i&&isNaN(e)&&isNaN(i))return!0;if(this._isArray(e)&&this._isArray(i)&&this._arrayEq(e,i))return!0;if("object"==typeof e&&"object"==typeof i&&this._objPropEq(e,i))return!0;throw new doh._AssertFailure("assertEqual() failed:\n	expected\n		"+e+"\n	but got\n		"+i+"\n\n",t)},doh.isNot=doh.assertNotEqual=function(e,i,t){if(void 0===e&&void 0===i)throw new doh._AssertFailure("assertNotEqual() failed: not expected |"+e+"| but got |"+i+"|",t);if(2>arguments.length)throw doh._AssertFailure("assertEqual failed because it was not passed 2 arguments");if(e===i||e==i)throw new doh._AssertFailure("assertNotEqual() failed: not expected |"+e+"| but got |"+i+"|",t);if(this._isArray(e)&&this._isArray(i)&&this._arrayEq(e,i))throw new doh._AssertFailure("assertNotEqual() failed: not expected |"+e+"| but got |"+i+"|",t);if("object"==typeof e&&"object"==typeof i&&this._objPropEq(e,i))throw new doh._AssertFailure("assertNotEqual() failed: not expected |"+e+"| but got |"+i+"|",t);return!0},doh._arrayEq=function(e,i){if(e.length!=i.length)return!1;for(var t=0;e.length>t;t++)if(!doh.assertEqual(e[t],i[t]))return!1;return!0},doh._objPropEq=function(e,i){if(null===e&&null===i)return!0;if(null===e||null===i)return!1;if(e instanceof Date)return i instanceof Date&&e.getTime()==i.getTime();var t;for(t in i)if(void 0===e[t])return!1;for(t in e)if(!doh.assertEqual(e[t],i[t]))return!1;return!0},doh._isArray=function(e){return e&&e instanceof Array||"array"==typeof e||!!doh.global.dojo&&void 0!==doh.global.dojo.NodeList&&e instanceof doh.global.dojo.NodeList},doh._setupGroupForRun=function(e){var i=this._groups[e];this.debug(this._line),this.debug("GROUP",'"'+e+'"',"has",i.length,"test"+(i.length>1?"s":"")+" to run")},doh._handleFailure=function(e,i,t){this._groups[e].failures++;var a="";if(t instanceof this._AssertFailure?(this._failureCount++,t.fileName&&(a+=t.fileName+":"),t.lineNumber&&(a+=t.lineNumber+" "),a+=t+": "+t.message,this.debug("	_AssertFailure:",a)):this._errorCount++,this.debug(t),i.runTest.toSource){var s=i.runTest.toSource();this.debug("	ERROR IN:\n		",s)}else this.debug("	ERROR IN:\n		",i.runTest);t.rhinoException?t.rhinoException.printStackTrace():t.javaException&&t.javaException.printStackTrace()},doh.setTimeout=function(e){return e()},doh._runPerfFixture=function(e,i){var t=this._groups[e];i.startTime=new Date;var a=new doh.Deferred;t.inFlight++,a.groupName=e,a.fixture=i,a.addErrback(function(t){doh._handleFailure(e,i,t)});var s,u=function(){i.tearDown&&i.tearDown(doh),t.inFlight--,!t.inFlight&&t.iterated&&doh._groupFinished(e,!t.failures),doh._testFinished(e,i,a.results[0]),doh._paused&&doh.run()},n=i.timeout;n>0&&(s=doh.setTimeout(function(){a.errback(Error("test timeout in "+(""+i.name)))},n)),a.addBoth(function(){s&&clearTimeout(s),u()});var l=i.results;l.trials=[];var r=doh._calcTrialIterations(e,i);return r.addErrback(function(e){i.endTime=new Date,a.errback(e)}),r.addCallback(function(t){if(t){var s=i.trialIterations;doh.debug("TIMING TEST: ["+i.name+"]\n		ITERATIONS PER TRIAL: "+t+"\n	TRIALS: "+s);var u=function(){var n=new Date,r=new doh.Deferred,o={countdown:t},c=function(t){for(;t;)try{if(t.countdown--,t.countdown){var s=i.runTest(doh);if(s instanceof doh.Deferred){var u={countdown:t.countdown};s.addCallback(function(){c(u)}),s.addErrback(function(t){doh._handleFailure(e,i,t),i.endTime=new Date,a.errback(t)}),t=null}}else r.callback(new Date),t=null}catch(n){i.endTime=new Date,r.errback(n)}};r.addCallback(function(e){var r={trial:i.trialIterations-s,testIterations:t,executionTime:e.getTime()-n.getTime(),average:(e.getTime()-n.getTime())/t};l.trials.push(r),doh.debug("\n		TRIAL #: "+r.trial+"\n	TIME: "+r.executionTime+"ms.\n	AVG TEST TIME: "+r.executionTime/r.testIterations+"ms."),s--,s?doh.setTimeout(u,i.trialDelay):(l.trials,i.endTime=new Date,a.callback(!0))}),r.addErrback(function(e){i.endTime=new Date,a.errback(e)}),c(o)};u()}}),0>a.fired&&doh.pause(),a},doh._calcTrialIterations=function(e,i){var t=new doh.Deferred,a=function(){var e=i.runTest,a={start:new Date,curIter:0,iterations:5},s=function(a){for(;a;)if(a.curIter<a.iterations)try{var u=e(doh);if(u instanceof doh.Deferred){var n={start:a.start,curIter:a.curIter+1,iterations:a.iterations};u.addCallback(function(){s(n)}),u.addErrback(function(e){i.endTime=new Date,t.errback(e)}),a=null}else a.curIter++}catch(l){return i.endTime=new Date,t.errback(l),void 0}else{var r=new Date,o=r.getTime()-a.start.getTime();if(i.trialDuration>o){var c={iterations:2*a.iterations,curIter:0};a=null,doh.setTimeout(function(){c.start=new Date,s(c)},50)}else{var m=a.iterations;doh.setTimeout(function(){t.callback(m)},50),a=null}}};s(a)};return doh.setTimeout(a,10),t},doh._runRegFixture=function(e,i){var t=this._groups[e];i.startTime=new Date;var a=i.runTest(this);if(i.endTime=new Date,a instanceof doh.Deferred){t.inFlight++,a.groupName=e,a.fixture=i,a.addErrback(function(t){doh._handleFailure(e,i,t)});var s=function(){i.tearDown&&i.tearDown(doh),t.inFlight--,!t.inFlight&&t.iterated&&doh._groupFinished(e,!t.failures),doh._testFinished(e,i,a.results[0]),doh._paused&&doh.run()},u=doh.setTimeout(function(){a.errback(Error("test timeout in "+(""+i.name)))},i.timeout||1e3);return a.addBoth(function(){clearTimeout(u),s()}),0>a.fired&&doh.pause(),a}},doh._runFixture=function(e,i){var t=this._groups[e];this._testStarted(e,i);var a=!1,s=null;try{if(i.group=t,i.setUp&&i.setUp(this),i.runTest){if("perf"===i.testType)return doh._runPerfFixture(e,i);var u=doh._runRegFixture(e,i);if(u)return u}i.tearDown&&i.tearDown(this)}catch(n){a=!0,s=n,i.endTime||(i.endTime=new Date)}var l=new doh.Deferred;return doh.setTimeout(this.hitch(this,function(){a&&this._handleFailure(e,i,s),this._testFinished(e,i,!a),!t.inFlight&&t.iterated?doh._groupFinished(e,!t.failures):t.inFlight>0&&(doh.setTimeout(this.hitch(this,function(){doh.runGroup(e)}),100),this._paused=!0),doh._paused&&doh.run()}),30),doh.pause(),l},doh._testId=0,doh.runGroup=function(e,i){var t=this._groups[e];if(t.skip!==!0&&this._isArray(t)){if(t.length>=i&&!t.inFlight&&1==t.iterated)return t.tearDown&&t.tearDown(this),doh._groupFinished(e,!t.failures),void 0;i||(t.inFlight=0,t.iterated=!1,t.failures=0),doh._groupStarted(e),i||(this._setupGroupForRun(e,i),t.setUp&&t.setUp(this));for(var a=i||0;t.length>a;a++){if(this._paused)return this._currentTest=a,void 0;if(doh._runFixture(e,t[a]),this._paused)return this._currentTest=a+1,this._currentTest==t.length&&(t.iterated=!0),void 0}t.iterated=!0,t.inFlight||(t.tearDown&&t.tearDown(this),doh._groupFinished(e,!t.failures))}},doh._onEnd=function(){},doh._report=function(){this.debug(this._line),this.debug("| TEST SUMMARY:"),this.debug(this._line),this.debug("	",this._testCount,"tests in",this._groupCount,"groups"),this.debug("	",this._errorCount,"errors"),this.debug("	",this._failureCount,"failures")},doh.togglePaused=function(){this[this._paused?"run":"pause"]()},doh.pause=function(){this._paused=!0},doh.run=function(){this._paused=!1;var e=this._currentGroup,i=this._currentTest,t=!1;e||(this._init(),t=!0),this._currentGroup=null,this._currentTest=null;for(var a in this._groups)if(!t&&a==e||t){if(this._paused)return;if(this._currentGroup=a,t?this.runGroup(a):(t=!0,this.runGroup(a,i)),this._paused)return}this._currentGroup=null,this._currentTest=null,this._paused=!1,this._onEnd(),this._report()},doh.standardDeviation=function(e){return Math.sqrt(this.variance(e))},doh.variance=function(e){var i=0,t=0;return dojo.forEach(e,function(e){i+=e,t+=Math.pow(e,2)}),t/e.length-Math.pow(i/e.length,2)},doh.mean=function(e){var i=0;return dojo.forEach(e,function(e){i+=e}),i/Math.max(e.length,1)},doh.min=function(e){return Math.min.apply(null,e)},doh.max=function(e){return Math.max.apply(null,e)},doh.median=function(e){return e.slice(0).sort()[Math.ceil(e.length/2)-1]},doh.mode=function(e){var i={},t=0,a=Number.MIN_VALUE;dojo.forEach(e,function(e){void 0!==i[e]?i[e]++:i[e]=1});for(var s in i)i[s]>a&&(a=i[s],t=s);return t},doh.average=function(e){var i,t=0;for(i=0;e.length>i;i++)t+=e[i];return t/e.length},tests=doh,"undefined"==typeof skipDohSetup&&function(){var e;try{if("undefined"!=typeof dojo){dojo.platformRequire({browser:["doh._browserRunner"],rhino:["doh._rhinoRunner"],spidermonkey:["doh._rhinoRunner"]});try{var i=dojo.isBrowser?dojo.global==dojo.global.parent||!Boolean(dojo.global.parent.doh):!0}catch(t){i=!0}i&&dojo.isBrowser&&dojo.addOnLoad(function(){if(dojo.global.registerModulePath&&dojo.forEach(dojo.global.registerModulePath,function(e){dojo.registerModulePath(e[0],e[1])}),dojo.byId("testList")){var e=dojo.global.testModule&&dojo.global.testModule.length?dojo.global.testModule:"dojo.tests.module";dojo.forEach(e.split(","),dojo.require,dojo),doh.setTimeout(function(){doh.run()},500)}})}else{if("function"==typeof load&&("function"==typeof Packages||"object"==typeof Packages))throw Error();if("function"==typeof load)throw Error();this.document}}catch(t){print("\n"+doh._line),print("The Dojo Unit Test Harness, $Rev: 20389 $"),print("Copyright (c) 2009, The Dojo Foundation, All Rights Reserved"),print(doh._line,"\n");try{var a="../../dojo/dojo.js",s="",u="dojo.tests.module",n="";for(e=0;arguments.length>e;e++)if(arguments[e].indexOf("=")>0){var l=arguments[e].split("=");"dohBase"==l[0]&&(n=l[1],n=n.replace(/\\/g,"/"),"/"!=n.charAt(n.length-1)&&(n+="/")),"dojoUrl"==l[0]&&(a=l[1]),"testUrl"==l[0]&&(s=l[1]),"testModule"==l[0]&&(u=l[1])}load(n+"_rhinoRunner.js"),a.length&&(this.djConfig||(djConfig={}),djConfig.baseUrl=a.split("dojo.js")[0],load(a)),s.length&&load(s),u.length&&dojo.forEach(u.split(","),dojo.require,dojo)}catch(t){print("An exception occurred: "+t)}doh.run()}}.apply(this,"undefined"!=typeof arguments?arguments:[null])}});