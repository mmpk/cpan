(function(){"use strict";function e(e,n,r){if(e&&"object"==typeof e&&e.href)return e;if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o={},l=e;l=l.trim();var c=s.exec(l);if(c){c=c[0];var b=c.toLowerCase();o.protocol=b,l=l.substr(c.length)}if(r||c||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var C="//"===l.substr(0,2);!C||c&&v[c]||(l=l.substr(2),o.slashes=!0)}if(!v[c]&&(C||c&&!_[c])){var w=l.indexOf("@");if(-1!==w){for(var L=l.slice(0,w),x=!0,M=0,E=d.length;E>M;M++)if(-1!==L.indexOf(d[M])){x=!1;break}x&&(o.auth=decodeURIComponent(L),l=l.substr(w+1))}for(var S=-1,M=0,E=h.length;E>M;M++){var z=l.indexOf(h[M]);-1!==z&&(0>S||S>z)&&(S=z)}-1!==S?(o.host=l.substr(0,S),l=l.substr(S)):(o.host=l,l="");for(var O=i(o.host),T=Object.keys(O),M=0,E=T.length;E>M;M++){var P=T[M];o[P]=O[P]}o.hostname=o.hostname||"";var D="["===o.hostname[0]&&"]"===o.hostname[o.hostname.length-1];if(o.hostname.length>p)o.hostname="";else if(!D)for(var k=o.hostname.split(/\./),M=0,E=k.length;E>M;M++){var A=k[M];if(A&&!A.match(f)){for(var j="",B=0,R=A.length;R>B;B++)j+=A.charCodeAt(B)>127?"x":A[B];if(!j.match(f)){var I=k.slice(0,M),N=k.slice(M+1),F=A.match(m);F&&(I.push(F[1]),N.unshift(F[2])),N.length&&(l="/"+N.join(".")+l),o.hostname=I.join(".");break}}}if(o.hostname=o.hostname.toLowerCase(),!D){for(var q=o.hostname.split("."),V=[],M=0;q.length>M;++M){var H=q[M];V.push(H.match(/[^A-Za-z0-9_-]/)?"xn--"+a.encode(H):H)}o.hostname=V.join(".")}o.host=(o.hostname||"")+(o.port?":"+o.port:""),o.href+=o.host,D&&(o.hostname=o.hostname.substr(1,o.hostname.length-2),"/"!==l[0]&&(l="/"+l))}if(!g[b])for(var M=0,E=u.length;E>M;M++){var W=u[M],U=encodeURIComponent(W);U===W&&(U=escape(W)),l=l.split(W).join(U)}var Y=l.indexOf("#");-1!==Y&&(o.hash=l.substr(Y),l=l.slice(0,Y));var G=l.indexOf("?");return-1!==G?(o.search=l.substr(G),o.query=l.substr(G+1),n&&(o.query=y.parse(o.query)),l=l.slice(0,G)):n&&(o.search="",o.query={}),l&&(o.pathname=l),_[c]&&o.hostname&&!o.pathname&&(o.pathname="/"),(o.pathname||o.search)&&(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.href=t(o),o}function t(t){"string"==typeof t&&(t=e(t));var n=t.auth||"";n&&(n=encodeURIComponent(n),n=n.replace(/%3A/i,":"),n+="@");var r=t.protocol||"",i=t.pathname||"",a=t.hash||"",s=!1,o="";void 0!==t.host?s=n+t.host:void 0!==t.hostname&&(s=n+(-1===t.hostname.indexOf(":")?t.hostname:"["+t.hostname+"]"),t.port&&(s+=":"+t.port)),t.query&&"object"==typeof t.query&&Object.keys(t.query).length&&(o=y.stringify(t.query));var l=t.search||o&&"?"+o||"";return r&&":"!==r.substr(-1)&&(r+=":"),t.slashes||(!r||_[r])&&s!==!1?(s="//"+(s||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):s||(s=""),a&&"#"!==a.charAt(0)&&(a="#"+a),l&&"?"!==l.charAt(0)&&(l="?"+l),r+s+i+l+a}function n(e,n){return t(r(e,n))}function r(n,r){if(!n)return r;if(n=e(t(n),!1,!0),r=e(t(r),!1,!0),n.hash=r.hash,""===r.href)return n.href=t(n),n;if(r.slashes&&!r.protocol)return r.protocol=n.protocol,_[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=t(r),r;if(r.protocol&&r.protocol!==n.protocol){if(!_[r.protocol])return r.href=t(r),r;if(n.protocol=r.protocol,!r.host&&!v[r.protocol]){for(var i=(r.pathname||"").split("/");i.length&&!(r.host=i.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),""!==i[0]&&i.unshift(""),2>i.length&&i.unshift(""),r.pathname=i.join("/")}return n.pathname=r.pathname,n.search=r.search,n.query=r.query,n.host=r.host||"",n.auth=r.auth,n.hostname=r.hostname||r.host,n.port=r.port,(void 0!==n.pathname||void 0!==n.search)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.slashes=n.slashes||r.slashes,n.href=t(n),n}var a=n.pathname&&"/"===n.pathname.charAt(0),s=void 0!==r.host||r.pathname&&"/"===r.pathname.charAt(0),o=s||a||n.host&&r.pathname,l=o,c=n.pathname&&n.pathname.split("/")||[],i=r.pathname&&r.pathname.split("/")||[],u=n.protocol&&!_[n.protocol];if(u&&(delete n.hostname,delete n.port,n.host&&(""===c[0]?c[0]=n.host:c.unshift(n.host)),delete n.host,r.protocol&&(delete r.hostname,delete r.port,r.host&&(""===i[0]?i[0]=r.host:i.unshift(r.host)),delete r.host),o=o&&(""===i[0]||""===c[0])),s)n.host=r.host||""===r.host?r.host:n.host,n.hostname=r.hostname||""===r.hostname?r.hostname:n.hostname,n.search=r.search,n.query=r.query,c=i;else if(i.length)c||(c=[]),c.pop(),c=c.concat(i),n.search=r.search,n.query=r.query;else if("search"in r){if(u){n.hostname=n.host=c.shift();var h=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;h&&(n.auth=h.shift(),n.host=n.hostname=h.shift())}return n.search=r.search,n.query=r.query,(void 0!==n.pathname||void 0!==n.search)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=t(n),n}if(!c.length)return delete n.pathname,n.search?delete n.path:n.path="/"+n.search,n.href=t(n),n;for(var d=c.slice(-1)[0],p=(n.host||r.host)&&("."===d||".."===d)||""===d,f=0,m=c.length;m>=0;m--)d=c[m],"."==d?c.splice(m,1):".."===d?(c.splice(m,1),f++):f&&(c.splice(m,1),f--);if(!o&&!l)for(;f--;f)c.unshift("..");!o||""===c[0]||c[0]&&"/"===c[0].charAt(0)||c.unshift(""),p&&"/"!==c.join("/").substr(-1)&&c.push("");var g=""===c[0]||c[0]&&"/"===c[0].charAt(0);if(u){n.hostname=n.host=g?"":c.length?c.shift():"";var h=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;h&&(n.auth=h.shift(),n.host=n.hostname=h.shift())}return o=o||n.host&&c.length,o&&!g&&c.unshift(""),n.pathname=c.join("/"),(void 0!==n.pathname||void 0!==n.search)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=r.auth||n.auth,n.slashes=n.slashes||r.slashes,n.href=t(n),n}function i(e){var t={},n=o.exec(e);return n&&(n=n[0],":"!==n&&(t.port=n.substr(1)),e=e.substr(0,e.length-n.length)),e&&(t.hostname=e),t}var a=require("punycode");exports.parse=e,exports.resolve=n,exports.resolveObject=r,exports.format=t;var s=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,l=["<",">",'"',"`"," ","\r","\n","	"],c=["{","}","|","\\","^","~","`"].concat(l),u=["'"].concat(l),h=["%","/","?",";","#"].concat(c).concat(u),d=["/","@","?","#"].concat(l),p=255,f=/^[a-zA-Z0-9][a-z0-9A-Z_-]{0,62}$/,m=/^([a-zA-Z0-9][a-z0-9A-Z_-]{0,62})(.*)$/,g={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=require("querystring")})();